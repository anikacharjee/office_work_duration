<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Office Work Duration Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link 
    rel="stylesheet" 
    href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    body { padding-top: 50px; }
    .container { max-width: 500px; }
    .alert-msg { font-weight: bold; color: #007bff; }
  </style>
</head>
<body>
  <div class="container text-center">
    <h3 class="mb-4">Office Work Duration Calculator</h3>
    <p class="alert-msg">
      Please enter your in-time (between 8:00 AM and 6:30 PM) in AM format
    </p>
    <input type="time" id="inTime" class="form-control mb-3" />
    <button class="btn btn-primary" onclick="calculateOutTime()">
      Calculate Out-Time
    </button>
    <div id="outputAlert" class="mt-3"></div>
  </div>

  <script>
    function calculateOutTime() {
      const input = document.getElementById('inTime').value;
      const outputDiv = document.getElementById('outputAlert');
      outputDiv.innerHTML = "";

      if (!input) {
        showAlert("Please enter a valid in-time.", "danger");
        return;
      }

      const [hourStr, minStr] = input.split(":");
      const inDate = new Date();
      inDate.setHours(parseInt(hourStr), parseInt(minStr), 0);

      const earliest = new Date();
      earliest.setHours(8, 0, 0);

      const latest = new Date();
      latest.setHours(18, 30, 0);

      if (inDate < earliest || inDate > latest) {
        showAlert("In-time must be between 8:00 AM and 6:30 PM.", "warning");
        return;
      }

      inDate.setMinutes(inDate.getMinutes() + 510); // 8 hrs 30 mins

      if (inDate > latest) {
        showAlert("Calculated out-time exceeds office hours (after 6:30 PM). Please enter an earlier in-time.", "danger");
        return;
      }

      let hours = inDate.getHours();
      let minutes = inDate.getMinutes().toString().padStart(2, '0');
      let suffix = "AM";

      if (hours >= 12) {
        suffix = "PM";
        if (hours > 12) hours -= 12;
      } else if (hours === 0) {
        hours = 12;
      }

      const formattedTime = `${hours}:${minutes} ${suffix}`;
      showAlert(`Your calculated out-time is <strong>${formattedTime}</strong>.`, "success");
    }

    function showAlert(message, type) {
      const outputDiv = document.getElementById('outputAlert');
      outputDiv.innerHTML = `
        <div class="alert alert-${type}" role="alert">
          ${message}
        </div>
      `;
    }
  </script>
</body>
</html>
